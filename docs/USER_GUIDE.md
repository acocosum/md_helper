# 个人知识库助手 - 用户指南

欢迎使用个人知识库助手！本指南将帮助您快速上手和有效使用这款工具，将您的Markdown文档转化为智能问答知识库。

## 目录
1. [快速开始](#快速开始)
2. [详细使用说明](#详细使用说明)
3. [常见问题解答](#常见问题解答)
4. [高级技巧](#高级技巧)
5. [故障排除](#故障排除)

## 快速开始

### 安装和启动
1. 确保您已安装Python 3.8或更高版本
2. 下载或克隆项目代码
3. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
4. 启动应用：
   ```
   streamlit run app.py
   ```
5. 浏览器会自动打开应用界面(通常是 http://localhost:8501)

### 基本使用流程
1. 在侧边栏输入OpenAI API密钥
2. 选择性填写自定义API地址(如使用第三方API)
3. 上传Markdown文件
4. 等待系统处理完成
5. 在文本框中输入问题
6. 获取基于您上传文档的智能回答

## 详细使用说明

### API设置

#### 官方OpenAI API
1. 登录或注册[OpenAI平台](https://platform.openai.com/)
2. 在账户设置中获取API密钥
3. 将密钥复制到应用侧边栏的"OpenAI API Key"输入框
4. 保持"自定义API地址"为空

#### 第三方API
1. 获取兼容OpenAI接口的第三方API密钥和地址
2. 将密钥复制到"OpenAI API Key"输入框
3. 在"自定义API地址"中输入基础URL(如`https://your-api-provider.com/v1`)
4. 系统会自动处理URL，无需添加`/chat/completions`或`/embeddings`等后缀

### 文件处理

#### 支持的文件格式
- 当前版本仅支持Markdown(.md)文件
- 请确保文件使用UTF-8编码以正确处理中文

#### 文件大小限制
- 建议控制文件大小在1MB以下，以获得最佳性能
- 较大文件会被切分成多个文本块，可能需要更长处理时间

#### 文件内容建议
- 结构良好的文档效果更佳（使用标题、段落、列表等）
- 文档内容应该事实性、信息丰富
- 避免过多装饰性文本和冗余内容

### 参数调整

在侧边栏中可以调整以下高级参数：

#### 文本块大小 (Chunk Size)
- **默认值**: 500
- **范围**: 100-1000
- **作用**: 控制每个文本块的字符数量
- **建议**: 
  - 较小的值(100-300)适合包含大量简短、独立信息的文档
  - 较大的值(500-1000)适合需要保持上下文连贯性的复杂文档

#### 文本块重叠 (Chunk Overlap)
- **默认值**: 50
- **范围**: 0-200
- **作用**: 控制相邻文本块之间的重叠字符数
- **建议**:
  - 增加重叠度有助于保持上下文连贯性
  - 但过高的重叠会增加API调用成本和处理时间

#### 检索数量 (Top K)
- **默认值**: 3
- **范围**: 1-10
- **作用**: 控制每次问答检索的相关文本块数量
- **建议**:
  - 简单明确的问题使用较小值(1-3)
  - 复杂问题或需要综合信息的问题使用较大值(4-10)

### 提问技巧

#### 有效的问题形式
- **具体明确**: "项目的目标用户群体是谁？" 优于 "告诉我关于用户的事"
- **单一焦点**: 每次提问专注于一个方面，而不是多个问题组合
- **上下文完整**: 提供必要的背景信息

#### 避免的问题类型
- 与上传文档无关的问题
- 过于宽泛的问题("这个文档讲了什么？")
- 需要推理或创造性回答的问题

### 理解回答结果

#### 答案部分
- 由AI根据检索到的相关文本块生成
- 尽量保留原文表述，减少"幻觉"
- 如果无法找到相关信息，会明确告知

#### 相关文本块
- 点击"查看相关文本块"可展开查看系统用于生成答案的原始文本
- 可以帮助您判断答案的准确性和完整性
- 当回答不满意时，检查文本块可能提供更多线索

## 常见问题解答

### 关于API和认证

**Q: 为什么需要API密钥？**  
A: 应用使用OpenAI或兼容的API进行文本向量化和问题回答，这些服务需要API密钥认证。

**Q: 我的API密钥安全吗？**  
A: 您的API密钥仅存储在本地会话中，不会被上传至任何服务器或被永久存储。应用关闭后密钥信息会被清除。

**Q: 能使用国内的API服务吗？**  
A: 可以，只要API兼容OpenAI的接口格式，在"自定义API地址"填入基础URL即可。

### 关于文档处理

**Q: 为什么目前只支持Markdown格式？**  
A: Markdown格式结构明确、易于解析，未来版本计划支持更多格式。

**Q: 处理大文档时速度很慢？**  
A: 文档处理需要多次API调用进行向量化，大文件耗时较长是正常的。可以考虑分割文档或调整文本块大小。

**Q: 上传多个文档如何操作？**  
A: 当前版本每次只能处理一个文档。需要处理多个文档时，建议合并为单个Markdown文件。

### 关于问答质量

**Q: 为什么有些答案不准确？**  
A: 可能的原因包括：
- 文档中没有包含相关信息
- 问题表述不够清晰
- 文本切分导致相关上下文丢失
- 系统参数设置不合适

**Q: 如何改善回答质量？**  
A: 尝试以下方法：
- 调整文本块大小和重叠参数
- 重新表述问题，使其更加具体
- 检查相关文本块，确认文档中是否包含所需信息
- 增加检索数量(Top K)参数值

## 高级技巧

### 优化文档结构

为获得最佳效果，建议按照以下方式组织Markdown文档：

```markdown
# 主标题

## 概述
简要介绍文档内容...

## 详细内容
### 小节1
具体内容...

### 小节2
具体内容...

## 总结
总结要点...
```

这种结构有助于系统更好地理解文档层次和内容关系。

### 性能优化

- **分割大型文档**: 将超过10页的文档分成多个相关主题的小文档
- **精简内容**: 移除无关的装饰性文本和冗余信息
- **聚焦专题**: 每个文档专注于一个主题或相关主题集

### 个性化使用案例

#### 学习笔记助手
1. 上传课程笔记的Markdown文件
2. 调整文本块大小为较小值(300)以精确定位知识点
3. 提问复习问题，如"解释概念X的核心原理"

#### 技术文档查询
1. 上传API文档或技术规范
2. 调整文本块大小为较大值(700-1000)以维持上下文
3. 提问具体实现问题，如"如何配置X功能的Y选项"

#### 研究资料分析
1. 上传研究文献摘要集合
2. 增加检索数量(Top K = 5-7)以获取更全面的信息
3. 提问比较性问题，如"方法A和方法B的主要区别是什么"

## 故障排除

### 常见错误

#### "API Key未设置"或"API客户端未初始化"
- **原因**: API密钥未正确输入或未保存
- **解决方案**: 
  1. 检查API密钥是否有空格或换行符
  2. 点击侧边栏的配置按钮确认设置

#### "401 Unauthorized"或"Authentication failed"
- **原因**: API密钥无效或已过期
- **解决方案**:
  1. 确认API密钥是否正确
  2. 检查API账户余额或限制
  3. 如使用第三方API，确认密钥对该服务有效

#### "404 Not Found"
- **原因**: 自定义API地址错误或服务不支持嵌入/聊天完成功能
- **解决方案**:
  1. 确认API基础URL正确（不包括/v1/chat/completions等路径）
  2. 确认该API支持OpenAI兼容的embeddings和chat completions接口

#### "处理超时"或"请求失败"
- **原因**: 网络问题或API服务响应慢
- **解决方案**:
  1. 检查网络连接
  2. 减小文档大小
  3. 调整文本块大小以减少API调用次数

### 联系支持

如果遇到无法解决的问题，请通过以下方式寻求帮助：

1. 在项目的GitHub仓库提交Issues
2. 提供详细的问题描述、错误信息和重现步骤
3. 注意不要在公开渠道分享您的API密钥

## 结语

通过本指南，您应该能够充分利用个人知识库助手的功能，将您的Markdown文档转化为可查询的智能知识库。随着使用经验的积累，您可以通过调整参数和优化文档结构来获得最佳体验。

祝您使用愉快！
